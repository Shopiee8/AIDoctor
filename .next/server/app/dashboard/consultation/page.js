(()=>{var e={};e.id=2503,e.ids=[2503],e.modules={643:e=>{"use strict";e.exports=require("node:perf_hooks")},787:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});let s=(0,t(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/user/studio/src/app/dashboard/consultation/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/user/studio/src/app/dashboard/consultation/page.tsx","default")},1708:e=>{"use strict";e.exports=require("node:process")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4573:e=>{"use strict";e.exports=require("node:buffer")},7252:e=>{"use strict";e.exports=require("express")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14975:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(82614).A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},16141:e=>{"use strict";e.exports=require("node:zlib")},16698:e=>{"use strict";e.exports=require("node:async_hooks")},19063:e=>{"use strict";e.exports=require("require-in-the-middle")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19771:e=>{"use strict";e.exports=require("process")},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},28482:(e,r,t)=>{Promise.resolve().then(t.bind(t,86575))},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},34729:(e,r,t)=>{"use strict";t.d(r,{T:()=>o});var s=t(60687),a=t(43210),i=t(4780);let o=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:t,...r}));o.displayName="Textarea"},37067:e=>{"use strict";e.exports=require("node:http")},37366:e=>{"use strict";e.exports=require("dns")},37830:e=>{"use strict";e.exports=require("node:stream/web")},44493:(e,r,t)=>{"use strict";t.d(r,{BT:()=>c,Wu:()=>d,ZB:()=>l,Zp:()=>o,aR:()=>n,wL:()=>u});var s=t(60687),a=t(43210),i=t(4780);let o=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...r}));o.displayName="Card";let n=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...r}));n.displayName="CardHeader";let l=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...r}));l.displayName="CardTitle";let c=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",e),...r}));c.displayName="CardDescription";let d=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",e),...r}));d.displayName="CardContent";let u=a.forwardRef(({className:e,...r},t)=>(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",e),...r}));u.displayName="CardFooter"},44708:e=>{"use strict";e.exports=require("node:https")},47002:e=>{function r(e){var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}r.keys=()=>[],r.resolve=r,r.id=47002,e.exports=r},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},56801:e=>{"use strict";e.exports=require("import-in-the-middle")},57075:e=>{"use strict";e.exports=require("node:stream")},57975:e=>{"use strict";e.exports=require("node:util")},58595:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(82614).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},59777:(e,r,t)=>{"use strict";t.r(r),t.d(r,{"7f6c800c6c0003abb97f8d88bfb8b7a46a1b55168b":()=>u});var s=t(91199);t(42087);var a=t(95427),i=t(68567);let o=[{english:"Chest Pain",arabic:"ألم في الصدر",category:"High-Risk"},{english:"Shortness of Breath",arabic:"ضيق في التنفس",category:"High-Risk"},{english:"Severe Headache",arabic:"صداع شديد",category:"High-Risk"},{english:"Loss of Consciousness",arabic:"فقدان الوعي",category:"High-Risk"},{english:"Severe Abdominal Pain",arabic:"ألم شديد في البطن",category:"High-Risk"},{english:"Headache",arabic:"صداع",category:"General"},{english:"Fever",arabic:"حمى",category:"General"},{english:"Cough",arabic:"سعال",category:"General"},{english:"Dizziness",arabic:"دوخة",category:"General"},{english:"Nausea",arabic:"غثيان",category:"General"},{english:"Vomiting",arabic:"قيء",category:"Gastrointestinal"},{english:"Diarrhea",arabic:"إسهال",category:"Gastrointestinal"},{english:"Constipation",arabic:"إمساك",category:"Gastrointestinal"},{english:"Insomnia",arabic:"أرق",category:"Neurological"},{english:"Abdominal Pain",arabic:"ألم في البطن",category:"Gastrointestinal"},{english:"Head",arabic:"رأس",category:"Body Part"},{english:"Chest",arabic:"صدر",category:"Body Part"},{english:"Abdomen",arabic:"بطن",category:"Body Part"},{english:"Back",arabic:"ظهر",category:"Body Part"},{english:"Hand",arabic:"يد",category:"Body Part"},{english:"Leg",arabic:"رجل",category:"Body Part"},{english:"Eye",arabic:"عين",category:"Body Part"},{english:"Ear",arabic:"أذن",category:"Body Part"},{english:"Nose",arabic:"أنف",category:"Body Part"},{english:"Mouth",arabic:"فم",category:"Body Part"},{english:"since an hour ago",arabic:"منذ ساعة",category:"Time"},{english:"since yesterday",arabic:"منذ يوم",category:"Time"},{english:"since a week ago",arabic:"منذ أسبوع",category:"Time"},{english:"now",arabic:"الآن",category:"Time"},{english:"this morning",arabic:"صباح اليوم",category:"Time"}];var n=t(33331);let l=i.z.object({role:i.z.enum(["user","model"]),content:i.z.string(),isReferral:i.z.boolean().optional().describe("Set to true if this is a referral message."),referralReason:i.z.string().optional().describe("The reason for the referral.")}),c=i.z.object({history:i.z.array(l),terms:i.z.array(i.z.any())}),d=a.ai.definePrompt({name:"consultationPrompt",input:{schema:c},output:{schema:l},prompt:`You are an empathetic and professional AI Doctor. Your goal is to assess a patient's symptoms and provide basic medical advice. You must communicate in the same language as the user (English or Arabic).

  Conversation History:
  {{#each history}}
  - {{role}}: {{content}}
  {{/each}}
  
  Medical Terminology Reference (both English and Arabic):
  {{#each terms}}
  - {{english}}: {{arabic}} ({{category}})
  {{/each}}

  Your tasks:
  1.  Analyze the user's latest message for medical symptoms using the provided terminology list.
  2.  Ask clarifying questions to understand the symptom's severity, duration, and nature. (e.g., "I understand you have a headache. Is it severe or mild? When did it start?").
  3.  **Referral Rule:** If the user mentions any "High-Risk" symptom (like 'chest pain', 'shortness of breath', 'severe headache', 'loss of consciousness'), you MUST immediately refer them to a human doctor. Your response must be ONLY a new model turn with the 'isReferral' flag set to true, and a 'referralReason'. The content should be something like: "Based on the symptoms you've described, it's important to speak with a human doctor immediately. I am connecting you now."
  4.  Provide simple, safe, evidence-based advice for non-high-risk symptoms.
  5.  Maintain a caring and professional tone.
  6.  Keep your responses concise.
  7.  Return ONLY your single new response as a model turn. Do not return the whole history.
  `}),u=a.ai.defineFlow({name:"consultationFlow",inputSchema:i.z.array(l),outputSchema:i.z.array(l)},async e=>{if(0===e.length)return[{role:"model",content:"Hello, I'm your AI Doctor. How can I help you today? Please describe your symptoms."}];let r=e[e.length-1]?.content.toLowerCase()||"";for(let t of o.filter(e=>"High-Risk"===e.category))if(r.includes(t.english.toLowerCase())||r.includes(t.arabic))return[...e,{role:"model",content:`Symptoms like '${t.english}' can be serious. It is important to speak with a human doctor for a full evaluation. I will connect you now.`,isReferral:!0,referralReason:`Patient reported high-risk symptom: ${t.english}. Immediate referral required.`}];let{output:t}=await d({history:e,terms:o});return t?[...e,t]:e});(0,n.D)([u]),(0,s.A)(u,"7f6c800c6c0003abb97f8d88bfb8b7a46a1b55168b",null)},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63144:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>i});var s=t(37413),a=t(93233);function i({children:e}){return(0,s.jsx)(a.DashboardLayout,{userRole:"Patient",children:e})}},73024:e=>{"use strict";e.exports=require("node:fs")},73136:e=>{"use strict";e.exports=require("node:url")},73496:e=>{"use strict";e.exports=require("http2")},73566:e=>{"use strict";e.exports=require("worker_threads")},74075:e=>{"use strict";e.exports=require("zlib")},74998:e=>{"use strict";e.exports=require("perf_hooks")},76760:e=>{"use strict";e.exports=require("node:path")},77030:e=>{"use strict";e.exports=require("node:net")},77598:e=>{"use strict";e.exports=require("node:crypto")},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},79646:e=>{"use strict";e.exports=require("child_process")},79748:e=>{"use strict";e.exports=require("fs/promises")},81630:e=>{"use strict";e.exports=require("http")},84297:e=>{"use strict";e.exports=require("async_hooks")},85866:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(82614).A)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]])},86575:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>g});var s=t(60687),a=t(43210),i=t(29523),o=t(44493),n=t(34729),l=t(14975),c=t(14283),d=t(58595),u=t(11516),h=t(40409),m=t(85866),p=t(4780),f=t(6475);let x=(0,f.createServerReference)("7f6c800c6c0003abb97f8d88bfb8b7a46a1b55168b",f.callServer,void 0,f.findSourceMapURL,"consultationFlow");function g(){let[e,r]=(0,a.useState)([]),[t,f]=(0,a.useState)(""),[g,y]=(0,a.useState)(!1),b=(0,a.useRef)(null),v=async()=>{y(!0),r([]);try{let e=await x([]);r(e)}catch(e){console.error("Error starting consultation:",e),r([{role:"model",content:"I'm sorry, I'm having trouble connecting. Please try again later."}])}finally{y(!1)}},j=async()=>{if(!t.trim())return;let s=[...e,{role:"user",content:t}];r(s),f(""),y(!0);try{let e=await x(s);r(e)}catch(e){console.error("Error continuing consultation:",e),r([...s,{role:"model",content:"I'm sorry, I encountered an error. Please rephrase your statement or try again."}])}finally{y(!1)}};return(0,s.jsx)("div",{className:"flex flex-col items-center justify-center min-h-[calc(100vh-10rem)] bg-muted/20",children:(0,s.jsxs)(o.Zp,{className:"w-full max-w-3xl h-[70vh] flex flex-col shadow-xl",children:[(0,s.jsxs)(o.aR,{className:"flex flex-row items-center justify-between",children:[(0,s.jsx)(o.ZB,{className:"font-headline",children:"AI Doctor Consultation"}),(0,s.jsxs)(i.$,{variant:"destructive",size:"sm",children:[(0,s.jsx)(l.A,{className:"mr-2 h-4 w-4"}),"Emergency"]})]}),(0,s.jsxs)(o.Wu,{ref:b,className:"flex-1 overflow-y-auto p-6 space-y-6",children:[0===e.length&&!g&&(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[(0,s.jsx)(c.A,{className:"h-16 w-16 text-primary/50 mb-4"}),(0,s.jsx)("h2",{className:"text-xl font-semibold text-muted-foreground",children:"Welcome to your AI Consultation"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Click the button below to begin your session."}),(0,s.jsx)(i.$,{onClick:v,className:"mt-6",children:"Start AI Consultation"})]}),e.map((e,r)=>(0,s.jsxs)("div",{className:(0,p.cn)("flex items-start gap-4","user"===e.role?"justify-end":"justify-start"),children:["model"===e.role&&(0,s.jsx)("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-primary text-primary-foreground flex items-center justify-center",children:(0,s.jsx)(c.A,{className:"h-6 w-6"})}),(0,s.jsxs)("div",{className:(0,p.cn)("max-w-md p-4 rounded-xl","user"===e.role?"bg-secondary text-secondary-foreground":"bg-primary/10"),children:[(0,s.jsx)("p",{className:"text-sm",children:e.content}),e.isReferral&&(0,s.jsxs)("div",{className:"mt-3 p-3 bg-destructive/10 border-l-4 border-destructive text-destructive-foreground rounded-r-lg",children:[(0,s.jsx)("p",{className:"font-bold text-sm",children:"Action Required"}),(0,s.jsx)("p",{className:"text-xs",children:e.referralReason})]})]}),"user"===e.role&&(0,s.jsx)("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-secondary text-secondary-foreground flex items-center justify-center",children:(0,s.jsx)(d.A,{className:"h-6 w-6"})})]},r)),g&&e.length>0&&(0,s.jsxs)("div",{className:"flex items-start gap-4 justify-start",children:[(0,s.jsx)("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-primary text-primary-foreground flex items-center justify-center",children:(0,s.jsx)(c.A,{className:"h-6 w-6"})}),(0,s.jsx)("div",{className:"max-w-md p-4 rounded-xl bg-primary/10 flex items-center",children:(0,s.jsx)(u.A,{className:"h-5 w-5 animate-spin text-primary"})})]}),g&&0===e.length&&(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[(0,s.jsx)(u.A,{className:"h-12 w-12 animate-spin text-primary mb-4"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Starting your consultation..."})]})]}),(0,s.jsx)("div",{className:"p-4 border-t bg-background",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(n.T,{placeholder:"Describe your symptoms here...",className:"pr-24",value:t,onChange:e=>f(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),j())},disabled:g||0===e.length}),(0,s.jsxs)("div",{className:"absolute top-1/2 right-3 -translate-y-1/2 flex gap-2",children:[(0,s.jsx)(i.$,{variant:"ghost",size:"icon",disabled:g,children:(0,s.jsx)(h.A,{className:"h-5 w-5"})}),(0,s.jsx)(i.$,{onClick:j,disabled:g||!t.trim(),children:(0,s.jsx)(m.A,{className:"h-4 w-4"})})]})]})})]})})}},88314:(e,r,t)=>{Promise.resolve().then(t.bind(t,787))},91645:e=>{"use strict";e.exports=require("net")},93148:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>o.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>h,tree:()=>c});var s=t(65239),a=t(48088),i=t(88170),o=t.n(i),n=t(30893),l={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);t.d(r,l);let c={children:["",{children:["dashboard",{children:["consultation",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,787)),"/home/user/studio/src/app/dashboard/consultation/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,63144)),"/home/user/studio/src/app/dashboard/layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,94431)),"/home/user/studio/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["/home/user/studio/src/app/dashboard/consultation/page.tsx"],u={require:t,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/dashboard/consultation/page",pathname:"/dashboard/consultation",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},94735:e=>{"use strict";e.exports=require("events")},95427:(e,r,t)=>{"use strict";t.d(r,{ai:()=>o});var s=t(41942),a=t(37612),i=t(9203);(0,s.config)({path:".env"});let o=(0,a.genkit)({plugins:[(0,i.YF)({apiKey:process.env.GOOGLE_API_KEY})],model:"googleai/gemini-2.0-flash"})}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[4447,9986,9567,6533,417,5367,5732,1834,7557,2221,5941,5026],()=>t(93148));module.exports=s})();